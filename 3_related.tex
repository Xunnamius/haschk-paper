\section{Prior Approaches and Related Work} \label{sec:related}

In this section, we examine prior approaches to guaranteeing resource integrity
over the internet and other related work. We also highlight the drawbacks to
these approaches and how our \SYSTEM{} implementations overcomes them.

\subsection{Prior Approaches}

Approaches implemented to protect users from compromised resource downloads in
the wild include: anti-malware software, heuristics, and blacklists.

Anti-malware software is a heuristic-based program designed for the specific
purpose of detecting and removing various kinds of malware. However, updates to
anti-malware definitions often lag behind or occur in response to the release of
crippling malware. For example, during the 2017 compromise of the HandBrake
distribution mirror, users who first ran the compromised HandBrake image through
\textit{VirusTotal}---a web service that will run a resource through several
dozen popular anti-malware products---received a report claiming no infections
were detected despite the presence of the Proton malware~\cite{SCA-HB1}. In the
2012 compromise of SourceForge's CDN, the malicious changes to the phpmyAdmin
image don't appear as malware to anti-malware software~\cite{SCA-PMA1}.

Similarly, all modern browsers employ heuristic and blacklist-based detection
and prevention schemes in an attempt to protect users from malicious content on
the internet. The warnings generated by browser-based heuristics and blacklists
are also reactive rather than proactive; hence, they are generally ineffective
at detecting active attacks on the integrity of the resources downloaded over
the internet. In the cases where problems \emph{are} detected, users are known
to ignore the resulting security warnings depending on an implementation's
UI~\cite{Clickthrough, Modic, Akhawe, ChromeClickThrough}. In this case,
Cherubini et al, Tan et al, and others conclude taking an opt-out approach
similar to that of anti-malware and spam filters is sufficient~\cite{Cherubini,
Tan}. That is: 1) clearly, visibly, and simply assert the danger of the download
and 2) privilege security over choice by rejecting the download by default while
making it inconvenient to ignore or click through the security warning. Our
\SYSTEM{} implementations were designed with this guidance in mind, with an
ideal implementation able to rely on Google Chrome's dangerous download
UI~\cite{ChromeClickThrough}.

\subsection{Related Work}

\noindent\textbf{Link Fingerprints and Subresource Integrity.} The Link
Fingerprints (LF) draft describes an early HTML anchor and URL based resource
integrity verification scheme~\cite{LF}. Subresource Integrity (SRI) describes a
similar production-ready HTML-based scheme designed with CDNs and web assets
(rather than generic resources) in mind. Like \SYSTEM{}, both LF and SRI employ
cryptographic digests to ensure no changes of any kind have been made to a
resource~\cite{SRI}. Unlike \SYSTEM{}, LF and SRI rely on the server that hosts
the HTML source to be secure; specifically, the checksums contained in the HTML
source must be accurate for these schemes to work. An attacker that has control
of the web server can alter the HTML and inject a malicious checksum. With
\SYSTEM{}, however, an attacker would additionally have to compromise whichever
distributed system hosted the mappings between Resource Identifiers and
Authoritative Checksums. \\

\noindent\textbf{Content-MD5 Header.} The Content-MD5 header field is a
deprecated email and HTTP header that delivers a checksum similar to those used
by Subresource Integrity. It was removed from the HTTP/1.1 specification because
of the inconsistent implementation of partial response handling between
vendors~\cite{HTTP1.1}. Further, the header could be easily stripped off or
modified by proxies and other intermediaries~\cite{MD5Header}. \\

\noindent\textbf{Deterministic Build Systems and Binary Transparency.} A
deterministic build system is one that, when given the same source, will
deterministically output the same binary on every run. For example, many
packages in Debian~\cite{ReproBuildsDebian} and Arch Linux can be rebuilt from
source to yield an identical byte for byte result~\cite{ReproBuilds}, allowing
for verification of the \emph{Development} and \emph{Integration} supply chain
phases (see \tblref{attacks}). Further, using a merkle tree~\cite{MerkleTree} or
similar construction, an additional chain of trust can be established that
allows for public verification of the \emph{Deployment}, \emph{Maintenance}, and
\emph{Retirement} supply chain phases. Companies such as Mozilla refer to the
latter as ``Binary Transparency,'' a public verification scheme that allows
third parties access to a complete listing of software source
updates~\cite{BinaryTransparency}. Third parties can take advantage of
deterministic build systems and Binary Transparency to ensure their software is
the same software deployed to every other system. In contrast, \SYSTEM{} allows
a user to verify the contents of any arbitrary internet resource automatically
while addressing co-hosting. \\

\noindent\textbf{Stickler and Cherubini et al.} Stickler~\cite{Stickler} by Levy
et al. is a JavaScript-based stand-in for Subresource Integrity for protecting
the integrity of web application files hosted on CDNs. Unlike \SYSTEM{},
Stickler does not require any modifications to the client to protect resources.
However, as it was designed for CDNs, concerns like co-hosting are outside of
Stickler's threat model. If the content server behind the CDN is compromised, as
was the case with Linux Mint, it would be trivial to modify the manifest file to
inject corrupted checksums.

Similarly, the automated checksum verification approach by Cherubini et
al.~\cite{Cherubini}---also based on Subresource Integrity---is vulnerable to
co-hosting. Cherubini's browser extension works by 1) looking for embedded
checksums in download links and 2) extracting hexadecimal strings that look like
checksums directly from the page. An attacker, after compromising the resource
file, need only modify the page's HTML file to inject a corrupted checksum
matching that resource, causing Cherubini's extension to misreport the
compromised download as safe~\cite{Cherubini}.

Unlike prior work, \SYSTEM{} is both automated and capable of mitigating the
co-hosting threat, significantly raising the bar for the attacker.
