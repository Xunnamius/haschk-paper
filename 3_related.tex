\section{Related Work} \label{sec:related}

In this section, we examine prior approaches to guaranteeing resource integrity
over the internet. We then highlight some drawbacks to these approaches and how
\SYSTEM{} differs. \\

\noindent\textbf{Anti-malware software, heuristics, and blacklists.}
Anti-malware software is a heuristic-based program designed for the specific
purpose of detecting and removing various kinds of malware. However, updates to
anti-malware definitions often lag behind or occur in response to the release of
crippling malware. For example, during the 2017 compromise of the HandBrake
distribution mirror, users who first ran the compromised HandBrake image through
\textit{VirusTotal}---a web service that will run a resource through several
dozen popular anti-malware products---received a report claiming no infections
were detected despite the presence of the Proton malware~\cite{SCA-HB1}. In the
2012 compromise of SourceForge's CDN, the malicious changes to the phpmyAdmin
image do not appear as malware to anti-malware software~\cite{SCA-PMA1}.

Similarly, all modern browsers employ heuristic and blacklist-based detection
and prevention schemes in an attempt to protect users from malicious content on
the internet. The warnings generated by browser-based heuristics and blacklists
are also reactive rather than proactive; hence, they are generally ineffective
at detecting active or novel attacks on the integrity of the resources
downloaded over the internet.

On the other hand, \SYSTEM{} relies on no heuristics or blacklists and is not
anti-malware software. \SYSTEM{} is a protocol for automating checksum
verification of resources. This ensures download integrity---that a user is
receiving the expected resource a provider is advertising---not that the
expected resource is not malware. \\

\noindent\textbf{Link Fingerprints and Subresource Integrity.} The Link
Fingerprints (LF) draft describes an early HTML hyperlinks and URI based
resource integrity verification scheme that ``provides a backward-compatible
technique for resource providers to ensure that the resource originally
referenced is the same as the resource retrieved by an end user.''~\cite{LF}.
The World Wide Web Consortium's (W3C) Subresource Integrity (SRI) describes a
similar HTML-based scheme designed exclusively with CDNs and web assets in mind.

Like \SYSTEM{}, both LF and SRI employ cryptographic digests to ensure no
changes of any kind have been made to a resource~\cite{SRI}. Unlike \SYSTEM{},
LF and SRI apply \emph{only to resources referenced by script and link HTML
elements}; \SYSTEM{}, on the other hand, can ensure the integrity of \emph{any
arbitrary resource downloaded over the internet}, even outside of HTML web pages
and browser software. Further, the checksums contained in the HTML source must
be accurate for SRI to work. If the system \emph{behind} the CDN is compromised,
the attacker can alter the HTML and inject a malicious checksum or even strip
checksums from the HTML entirely. With \SYSTEM{}, however, an attacker would
additionally have to compromise the separate backend system that advertises the
provider's resources, thus raising the bar. \\

\noindent\textbf{Content-MD5 Header.} The Content-MD5 header field is a
deprecated email and HTTP header that delivers a checksum similar to those used
by Subresource Integrity. It was removed from the HTTP/1.1 specification because
of the inconsistent implementation of partial response handling between
vendors~\cite{HTTP1.1}. Further, the header could be easily stripped off or
modified by proxies and other intermediaries~\cite{MD5Header}. \SYSTEM{}
exhibits none of these weaknesses. \\

\noindent\textbf{Deterministic Build Systems and Binary Transparency.} A
deterministic build system is one that, when given the same source, will
deterministically output the same binary on every run. For example, many
packages in Debian~\cite{ReproBuildsDebian} and Arch Linux can be rebuilt from
source to yield an identical byte for byte result~\cite{ReproBuilds}, allowing
for verification of the \emph{Integration} and perhaps \emph{Development} supply
chain phases (see \tblref{attacks}). Further, using a merkle
tree~\cite{MerkleTree} or similar construction, an additional chain of trust can
be established that allows for public verification of the \emph{Deployment},
\emph{Maintenance}, and \emph{Retirement} supply chain phases. Companies such as
Mozilla refer to the latter as ``Binary Transparency.''

Like \SYSTEM{}, binary transparency establishes a public verification scheme
that allows third party consumers access to a listing of source updates
advertised by a provider~\cite{BinaryTransparency}. Consumers can leverage
deterministic build systems and Binary Transparency together to ensure their
software is the same software deployed to every other system. Unlike \SYSTEM{},
binary transparency only allows a user to verify the integrity of \emph{source
updates to binaries}; our protocol allows a user to verify the integrity of
\emph{any arbitrary resource} while specifically addressing co-hosting. \\

\noindent\textbf{Stickler and Cherubini et al.} Stickler~\cite{Stickler} by Levy
et al. is an automated JavaScript-based stand-in for SRI for protecting the
integrity of web application files hosted on CDNs. Stickler does not require any
modifications to the client (\ie{ a frontend}), instead delivering a bootloader
to load and verify resources signed before the fact. However, as it was designed
to stand-in for SRI, Stickler inherits some of SRI's limitations. Specifically:
Stickler was not designed to protect arbitrary resource downloads and, if the
publisher's server is compromised, Stickler's bootloader can be stripped out of
the initial HTTP response altogether. Something like this is not possible with
\SYSTEM{}.

The automated checksum verification approach described by Cherubini et
al.~\cite{Cherubini}, also based on SRI, is similarly vulnerable to (and relies
upon) co-hosting. Cherubini's browser extension works by both looking for
embedded checksums in download links (SRI) and extracting hexadecimal strings
that look like checksums directly from the HTML source. An attacker, after
compromising the resource file, need only modify the provider's HTML file to
inject a corrupted ``integrity'' attribute containing a checksum matching that
corrupted resource, causing Cherubini's extension to misreport the dangerous
download as safe~\cite{Cherubini}. Additionally, Cherubini's extension: (1) does
not alert users when corresponding authoritative checksums are not found, which
means an attacker can simply strip all checksums from the server response to
pass off compromised resources to users; (2) considers a download ``safe'' so
long as \emph{any checksum found on the page matches it}, which means an
attacker can just inject the compromised checksum somewhere in the HTML source
alongside the legitimate checksum to similarly pass off compromised resources to
users; (3) does not support direct downloads, \ie{ when a user enters a
resource's URI into the browser manually rather than click a hyperlink}. None of
this is a problem for \SYSTEM{}.
