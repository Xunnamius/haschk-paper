\section{Introduction} \label{sec:introduction}

\TODO{Downloading is easy but risky and the risk is dividided into three
categories.}

In 2010, through compromising legitimate applications available on trusted
vendor websites, nation-state actors launched the Havex malware, targeting
aviation, defense, pharmaceutical, and petrochemical companies in Europe and the
United States~\cite{SCA-HAVEX}. In 2012, hackers compromised an official
phpMyAdmin download mirror hosted by reputable software provider SourceForge.
The backdoored version of the popular database frontend was downloaded by
hundreds of users, potentially allowing attackers to gain access to private
customer data~\cite{SCA-PMA}. In 2016, hackers broke into the Linux Mint
distribution server and replaced a legitimate Mint ISO with one containing a
backdoor, infecting hundreds of machines with the malware~\cite{SCA-MINT1,
SCA-MINT2}. Over a four day period in 2017, users of the popular HandBrake open
source video transcoder on Mac/OSX were made aware that, along with their
expected video software, they may have also downloaded a trojan that was
uploading their sensitive data to a remote server. HandBreak developers
recommended users perform checksum validation to determine if their install was
compromised.

As every internet user is most certainly aware, downloading resources over the
internet comes with considerable risk. We divide this risk into three
categories: response authentication, communication confidentiality, and resource
integrity.

Response authentication allows us to determine if a response received indeed
originates from its purported source. This can be accomplished through the
adoption of a Public Key Infrastructure (PKI) scheme~\cite{PKI}. Communication
confidentiality, on the other hand, allows us to keep the data transacted
between two or more parties private except to said parties. This is can be
accomplished through some form of symmetric or asymmetric encryption. Finally,
resource integrity allows us to verify that the data we are receiving is the
data we are expecting to receive.

\TODO{Narrow scope of the paper to third risk, and relate to supply chain
attacks.}

When it comes to response authentication and communication confidentiality
concerns on the internet, the state of the art in attack mitigation is Transport
Layer Security (TLS) and its Hyper Text Transfer Protocol (HTTP)/PKI based
implementation, HTTPS~\cite{TLS1.2, TLS1, TLS0, HTTPS, PKI}. Assuming well
behaved certificate authorities and modern browsing software, TLS and related
protocols, when properly deployed, mitigate myriad attacks on authentication
confidentiality.

However, as a \textit{communication} protocol, TLS only guarantees the integrity
of each \textit{end to end communication} via message authentication code
(MAC)~\cite{TLS1.2}. But protected encrypted communications mean nothing if the
contents of those communications are corrupted before the fact. Hence, the
integrity of resources at the application layer (rather than the transport
layer) is outside of the model addressed by TLS and HTTPS~\cite{TLS1.2, HTTPS}.

Attacks on resource integrity can be considered a subset of \emph{Supply Chain
Attacks} (SCA). Rather than attack an organization directly, SCAs are
the compromise of an organization's software source code (or any product) via
cyber attack, insider threat, upstream asset compromise, trusted hardware/vendor
compromise, or other attack on one or more phases of the software development
life cycle. These attacks are hard to prevent, hard to detect, and have the goal
of infecting and exploiting victims by abusing the trust between consumer and
software vendor~\cite{SCA}.

\TODO{State of the art dealing with supply chain attacks: checksums.}

Ensuring the integrity of resources exchanged over the internet despite SCAs and
other active attacks is a well studied problem~\cite{MD5Header, HTTP1.1, HTTPS,
SRI, LF, OpenPGP1, DNSSEC, PKI}. The de facto standard for addressing this risk
is with the use of \textit{checksums} coupled with some secure transport medium
like TLS/HTTPS. Checksums in this context are cryptographic digests generated by
a cryptographic hashing function run over the resource's file contents. They are
supposedly hosted on a separate system than the resources they protect and are
used to verify a resourceâ€™s integrity to an end user.

\TODO{Why checksums are bad (may be folded into previous para): (1) tedious for
users and (2) easily compromised by many existing supply chain attacks (not sure
about the last one).}

\TODO{Back to the Linux Mint example. The hacker changed the checksum too, because they hacked the host via a common wordpress vulnerability.}

Checksums are problematic for a whole host of reasons, the foremost being that
the clear majority of end users will not be burdened with manually calculating
them. And even if they did, said user must search for the corresponding
``correct'' checksum to verify their calculation. Managing that, if they then
recognize the checksums are different, the user is then expected to ``do the
right thing,'' whatever that happens to be in context.

\TODO{DNSCHK as replacement for checksums that addresses both problems through
(1) simple extensions to browsers or other tools and (2) whatever the general
name is for the backend stuff which can be implemented on DNSSEC or a DHT (or
maybe even something else we haven't thought of).}

In this paper, we propose \SYSTEM{}, \TODO{(deliniate between approach and
implementations?)}. Unlike \TODO{(compare and contrast)}.

As a replacement for manual checksum verification, \SYSTEM{} addresses a similar
security model and (see \tblref{attacks}). AH calculation is necessarily more
likely to occur later in the software development life cycle or very early in
the deployment process. If an attacker is able to execute a successful SCA
before the AH is calculated, \SYSTEM{} would propagate the compromised
Authoritative Hash.

\TODO{How do we evaluate it.}

We carefully and extensively evaluate the security, scalability, and performance
of our automated defense against resource corruption to demonstrate the
effectiveness and high practicality of the \SYSTEM{} approach. Specifically, we
find no obstacles to efficient scalability given choice of distributed system
and no performance overhead compared to downloads without \SYSTEM{}. We further
provide a publicly accessible empirical demonstration of \SYSTEM{}'s protective
utility via a patched HotCRP instance\footnote{The patched HotCRP instance is
available at https://tinyurl.com/dnschk-hotcrp}.

In summary, our primary contributions are:

\begin{itemize}

  \item We propose a novel practical defense against receiving malicious,
  corrupted, or compromised resources over the internet. Contrasted with current
  solutions, our defense requires no source code or infrastructure changes at
  any level other than DNS, does not employ unreliable heuristics, does not
  interfere with other software or extensions that also handle resource
  downloads, and can be transparently deployed without adding to the
  \textit{fragility} of DNSSEC-enabled systems; it protects end users whose
  software implements \SYSTEM{} while remaining unnoticeable to users of whose
  software does not.

  \item We present our prototype \SYSTEM{} implementations for Google Chrome and
  FileZilla and demonstrate its effectiveness in automatically and transparently
  mitigating the accidental consumption of compromised resources from a
  compromised server hosting a compromised web portal. To the best of our
  knowledge, this is the \emph{first} system providing such capabilities with
  little implementation cost and at no cost to the end user.

  \item We carefully and extensively evaluate the security, scalability, and
  performance of our automated defense against resource corruption to
  demonstrate the effectiveness and high practicality of the \SYSTEM{} approach.
  Specifically, we find no obstacles to efficient scalability given choice of
  distributed system and no performance overhead compared to downloads without
  \SYSTEM{}. We further provide a publicly accessible empirical demonstration of
  \SYSTEM{}'s protective utility via a patched HotCRP instance.

\end{itemize}

We release the \SYSTEM{} solution to the community as open source software to
prompt exploration of the \SYSTEM{} approach\footnote{The \SYSTEM{} Chrome
extension is available at https://tinyurl.com/dnschk-actual}.

\TODO{DELETE: With this research, we explore a novel method of verifying the
integrity of resources downloaded over the internet that is a complete
replacement for traditional checksums. We approach the problem with three key
concerns in mind: a) implementations provide security guarantees transparently
without adding any extra burden on the end user, \ie neither grappling with a
new user interface nor any additional labor is required during standard usage;
b) configuring the validation method is simple for service administrators and
system operators to integrate and deploy; and c) no new HTML or JavaScript
language additions, application source changes, or web server/infrastructure
alterations are necessary. Hence, we propose \SYSTEM{}, a novel automated
resource validation method that is transparent to end users and simple for
administrators to deploy. We implement \SYSTEM{} as a proof-of-concept Google
Chrome extension as well as a patch to the FileZilla FTP client. We evaluate the
security, scalability, and performance of the \SYSTEM{} approach and provide a
publicly accessible demonstration of its utility via a patched HotCRP instance.}

\TODO{DELETE: Hence, despite the resilient nature of HTTPS and the powerful
security properties it guarantees, end users are still vulnerable to attacks on
resource integrity. This can occur at the point of distribution, such as a
compromised node in a third party CDN that delivers compromised malicious
resources masquerading as popular public software libraries. \TODO{(choose an
example from background section)}. It can occur when an adversary gains control
of some aspect of the software deployment process, such as \TODO{(talk about
NotPetya?)}. Moreover, an adversary can render HTML-based additions to HTTPS
such as Content-MD5 header~\cite{MD5Header} and Subresource Integrity
(SRI)~\cite{SRI} ineffective by compromising the system that hosts the software
or its download portal or update/maintenance mechanism.}

\TODO{DELETE: HTTPS and related protocols (HSTS, DNSSEC, etc) are not a panacea,
however. Unlike authenticity and confidentiality, \textit{resource integrity}
deals with the content of a communication; specifically: ensuring the bytes
received at the end of a transaction are the bytes we expected to receive. For
example, a binary expected to be 10MiB, when downloaded over the internet,
should not be received as an 11MiB executable, even if the communication was
confidential between parties and the receiver can verify that the resource came
from the intended source. Similarly, it would be ill advised to execute a 10MiB
binary that, for one reason or another, had half its bits flipped by the time it
was received. This can occur despite the integrity guarantee provided by
TLS/HTTPS because,}
