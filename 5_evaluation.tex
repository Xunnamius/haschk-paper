\section{Evaluation} \label{sec:evaluation}

The primary goal of any \SYSTEM{} implementation is to alert end-users when the
resource they have downloaded is something other than what they were expecting.
We tested the effectiveness of our approach using the \SYSTEM{} extension for
Google Chrome, a real-world deployment of HotCRP, and a random sampling of
papers published in previous \CONFERENCE{} proceedings.

\subsection{Threat Model}

\subsubsection{Compromised Resource}

We consider the case where an adversary can influence or even completely control
the victim's resource distribution mechanism (web page, file server, CDN, etc)
in any way. In this context, the adversary can trick the user into downloading a
compromised resource of the adversary's choice. This can be accomplished by
compromising the resource on the victim's system or tricking the user into
downloading a compromised resource on the adversary's remote system.

In this case, the adversary does not have control over any DNS zone(s) relevant
to the function of \SYSTEM{}.

If the adversary does not alter the Resource Identifier, the compromised
resource will fail integrity validation during the NAH Validation step.

If the adversary does alter the Resource Identifier, there are two
possibilities: a) the new Resource Identifier \textit{does not} exist in the DNS
zone, in which case \SYSTEM{} will fail to resolve the NAH, hence the NAH
Validation step will fail; b) the new Resource Identifier \textit{does} exist in
the DNS zone, therefore the "new" RI must be pointing to a different file's
hash. Unless the adversary's goal is to swap one or more files protected by
\SYSTEM{} and a particular DNS zone with another file also protected by
\SYSTEM{} and in that same zone, the NAH Validation step will fail. For the
aforementioned "swap" to work, the adversary would be required to both change
the RI and also offer to the victim the \SYSTEM{} protected file the "new" RI
corresponds to, which shrinks the attack surface significantly.

\subsubsection{Compromised Authoritative Hash}

We consider the case where an adversary can completely control the victim DNS
zone(s) that allow \SYSTEM{} to function. Therefore, the adversary can return an
authoritative response of their choice to any DNS query.

In this case, the adversary does not have control over the victim's file
distribution mechanism (web page, file server, CDN, etc).

DNSSEC ensures the validity and authenticity of DNS responses. In order for the
adversary to control any relevant DNS zones, they must have access to the
authoritative DNS server and/or the appropriate DNSSEC keys.

Even if the adversary achieved this level of compromise, they do not have the
ability to deliver a malicious payload in this case. However, the adversary
could use control over the relevant DNS zones to cause denial-of-service attacks
against those attempting to download the resource by causing all NAH Validation
checks to fail. This is mitigated by \SYSTEM{} allowing the user to "override"
its error states, similarly to Google Chrome's invalid HTTPS certificate warning
page allowing advanced users to pass through.

\subsubsection{Compromised Resource and Authoritative Hash}

We consider the case where an adversary can influence or even completely control
the victim's resource distribution mechanism (web page, file server, CDN, etc)
in any way. Additionally, the adversary can completely control the victim DNS
zone(s) that allow \SYSTEM{} to function. Therefore, the adversary can make the
user download a compromised resource and also return a (compromised) AH that
legally corresponds to said compromised resource.

\subsubsection{Determining the Origin Domain}

If an adversary manages to compromise a web page/server, they have two options.
They can mutate the resource directly, which would be observable via DNSCHK.
They could also mutate the web/download page itself, replacing the anchor with a
malicious one that points to a compromised resource on the adversary's remote
system. This system could be configured with valid DNSCHK DNS TXT records,
allowing the adversary to trick DNSCHK into green lighting the resource without
complaint. Similarly, an adversary could redirect the user to an valid and
innocuous (but compromised) page that very quickly redirects the user again to
the compromised resource with the goal of tricking DNSCHK.

In order to prevent such implementation-level attacks, we make a distinction
between the domain that the hyperlink containing the desired resource references
and the OD---or the domain of the document within which said hyperlink exists. The
extension must be implemented such that the OD is resolved as early as possible
in the page loading process. The scope of the OD is at the tab level, meaning
there is one OD determined for each open browser tab. Once determined for a tab,
the OD should not be recalculated for some period of time. If the browser is
navigated within this time period, the user will be asked to verify that the OD
is what they expect it to be (should be a familiar URL).

We implement this mitigation using chrome Download API's DownloadItem::referrer
property as the OD. We catch redirection attacks by assuming any page that
begins a download in under 3 seconds is suspicious and requires affirmation by
the user.

\TODO{Figuring out OD for FTP is really easy, though}

\subsection{Real-World Resource Corruption Detection with Google Chrome and HotCRP}

\TODO{It also seems from ACME that HTTP challenges are good enough of a proof to
issue TLS certificates, so why not good enough for checksums? Threat model of
ACME thoroughly goes through this~\cite{draft-ACME}.}

\subsection{Deployment and Scalability}

\TODO{Discuss envisioned deployment strategies for resource providers.}

\TODO{Can this be scaled? Yes it can. What are the practical limits? EDNS0 means
it is not DNS size, though packet fragmentation is still a concern. How about
max record length? Maximum number of records? A service could have thousands or
millions of files it serves! Can DNS handle that? DHT failover is still a
solution anyway.}

\subsection{Performance Overhead}

\TODO{Additional Download Latency, Additional Network Load, Runtime overhead,
etc. All nixed.}
