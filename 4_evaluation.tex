\section{(unfinished) Evaluation} \label{sec:evaluation}

The primary goal of any \SYSTEM{} implementation is to alert end-users when the
resource they have downloaded is something other than what they were expecting.
We tested the effectiveness of our approach using the \SYSTEM{} extension for
Google Chrome, a real-world deployment of HotCRP, and a random sampling of
papers published in previous \CONFERENCE{} proceedings.

\subsection{Threat Model and Considerations}

\subsubsection{Compromised Resource}

We consider the case where an attacker can influence or even completely control
the victim's resource distribution mechanism (web page, file server, CDN, etc)
in any way. In this context, the attacker can trick the user into downloading a
compromised resource of the attacker's choice. This can be accomplished by
compromising the resource on the victim's system or tricking the user into
downloading a compromised resource on the attacker's remote system.

In this case, the attacker does not have control over any DNS zone(s) relevant
to the function of \SYSTEM{}.

If the attacker does not alter the Resource Identifier, the compromised
resource will fail integrity validation during the NAC Validation step.

If the attacker does alter the Resource Identifier, there are two
possibilities: a) the new Resource Identifier \textit{does not} exist in the DNS
zone, in which case \SYSTEM{} will fail to resolve the NAC, hence the NAC
Validation step will fail silently; b) the new Resource Identifier \textit{does}
exist in the DNS zone, therefore the ``new'' RI must be pointing to a different
resource's checksum. Unless the attacker's goal is to swap one or more
resources protected by \SYSTEM{} and a particular DNS zone with another resource
also protected by \SYSTEM{} and in that same zone, the NAC Validation step will
fail. For the aforementioned ``swap'' to work, the attacker would be required
to both change the RI and also offer to the victim the \SYSTEM{} protected
resource the ``new'' RI corresponds to, which shrinks the attack surface
significantly.

\subsubsection{Compromised Authoritative Checksum}

We consider the case where an attacker can completely control the victim DNS
zone(s) that allow \SYSTEM{} to function. Therefore, the attacker can return an
authoritative response of their choice to any DNS query.

In this case, the attacker does not have control over the victim's resource
distribution mechanism (web page, file server, CDN, etc).

DNSSEC ensures the validity and authenticity of DNS responses. In order for the
attacker to control any relevant DNS zones, they must have access to the
authoritative DNS server and/or the appropriate DNSSEC keys.

Even if the attacker achieved this level of compromise, they do not have the
ability to deliver a malicious payload in this case. However, the attacker
could use control over the relevant DNS zones to cause denial-of-service style
attacks against those attempting to download the resource by causing all NAC
Validation checks to fail. This is mitigated by \SYSTEM{} allowing the user to
``override'' its error states; \ie \SYSTEM{} does not (and cannot, thanks to
the Chrome/WebExtensions API) mutate a downloaded resource. See
\secref{discussion} for further discussion on limitations due to the
Chrome/WebExtensions API.

\subsubsection{Compromised Resource and Authoritative Checksum}

We consider the case where an attacker can influence or even completely control
the victim's resource distribution mechanism (web page, file server, CDN, etc)
in any way. Additionally, the attacker can completely control the victim DNS
zone(s) that allow \SYSTEM{} to function. Therefore, the attacker can make the
user download a compromised resource and also return a (compromised) AC that
legally corresponds to said compromised resource.

\subsubsection{Determining the Origin Domain}

If an attacker manages to compromise a web page/server, they have two options.
They can mutate the resource directly, which would be observable via \SYSTEM{}.
They could also mutate the web/download page itself, replacing the anchor with a
malicious one that points to a compromised resource on the attacker's remote
system. \SYSTEM{} will still catch this due to the Chrome API's
\texttt{DownloadItem::referrer} property (distinct from the concept of an HTTP
referrer).

However, a clever attacker might be able to trick the Chrome API into populating
\texttt{DownloadItem::referrer} by redirecting the user to a valid and innocuous
page that very quickly redirects the user again to a compromised resource with
the goal of tricking the Chrome API into supplying \SYSTEM{} with a chosen
\texttt{DownloadItem::referrer}.

In order to prevent such implementation-specific attacks, we make a distinction
between the domain that the hyperlink containing the desired resource references
and the Origin Domain (OD)---or the domain of the document within which said
hyperlink exists. The extension is implemented such that the OD is resolved as
early as possible in the page loading process. The scope of the OD is at the tab
level, meaning there is one OD determined for each open browser tab. Once
determined for a tab, the OD should not be recalculated for some period of time.
If the tab is navigated and a download is started within a chosen time window,
the user will be asked to verify that the OD is what they expect it to be
(should be a familiar URL).

We catch potential redirection attacks by assuming any navigation that results
in a direct download up to three (3) seconds after the page has loaded is
suspicious and requires affirmation by the user. We expect this extreme
Chrome-specific edge case to occurrence very rarely, if at all.

\subsection{Real-World Resource Corruption Detection with Google Chrome and HotCRP}

\PUNT{As described in the IETF ACME draft specification, HTTP and DNS based
authentication challenges are a good enough basis to issue TLS certificates for
services such as the popular TLS Certificate Authority \emph{Let's
Encrypt}~\cite{draft-ACME}.}

To further evaluate the effectiveness of our mitigation, we tested our
proof-of-concept \SYSTEM{} Chrome extension implementation against a series of
common real-world resource integrity violations. The impetus behind any such
resource integrity SCA is to have the resource pass through undetected with the
hope that an unsuspecting user will interact with it.

As a test bed, we launched a heavily modified version of the popular open source
research submission and peer review software, \emph{HotCRP}. Our modifications
allowed us to interactively corrupt submissions and manipulate relevant DNS
entries. We uploaded a variety of different resources, including legitimate
PDFs, to our HotCRP instance.

We then selectively corrupted half of these resources with random bit flips.
Interesting to note: the HotCRP instance did not update the checksums of the
resources we corrupted. The only way to notice the attack would be to manually
validate PDFs downloaded from HotCRP after the fact, something most users are
not willing to do. Further, leveraging our administrator access to the instance,
we manually uploaded files known to be malicious, replacing previously submitted
innocuous PDFs in the HotCRP backend. We also uploaded resources without
including them in our DNS zone file.

When we attempted to download the corrupted resources, including those uploaded
manually via side channel, \SYSTEM{} correctly flagged each corrupted resource.
Unmodified resources were not flagged and so were not affected; this includes
the resources whose ACs we purposely excluded from our DNS zone file.

Further, we implemented a ``redirection'' attack wherein a ``compromised'' PHP
script added to the HotCRP instance redirected users several times before
quickly triggering the download of a corrupted resource from a disparate domain.
\SYSTEM{} correctly flagged this download as suspicious once the download began,
successfully warning the user.

We conclude that our proof-of-concept \SYSTEM{} implementation and approach are
more effective than existing approaches at detecting integrity violations in
arbitrary resources on the internet at scale; this is evident especially when
\SYSTEM{} is compared to the de facto standard, checksums.

\subsection{Deployment and Scalability}

With the HotCRP demo, the totality of our resource deployment scheme consisted
of the addition of a new TXT entry to our DNS zone file---accomplished via API
call---during HotCRP's paper submission process. This new TXT entry consisted of
a mapping between a RI and its corresponding AC.

We find a DNS record addition or update during the resource deployment process
to be simple enough for service administrators to implement and presents no
significant burden to deployment outside of DNS API integration into an
development team or other entity's software build and deployment toolchain.

As \SYSTEM{} is predicated on a distributed authenticated highly-available
backend, we conclude that the scalability of \SYSTEM{} can be reduced to the
scalability of its backend. We are aware of no other obstacles to scalability
beyond those imposed by the underlying distributed system.

In respect to DNS specifically, packet fragmentation can be a concern for high
performance networks~\cite{EDNS}, but this is an artifact of DNSSEC and related
protocols rather than \SYSTEM{}~\cite{DNSSEC}. Further, we are aware of no
practical limits or protocol-based restrictions on the scalability of a DNS zone
file itself or its sub-zones. A service can host tens of thousands of resource
records in their DNS zone file~\cite{DNS1, DNS2}.

\subsection{Performance Overhead}

While evaluating \SYSTEM{}, we observed no discernible additional network load
or CPU usage with the extension loaded into Chrome; hence, we found that
\SYSTEM{} introduces no additional performance overhead outside of requiring
Chrome to function. As \SYSTEM{} does not interrupt or manipulate resources as
they are being downloaded, there is no additional download latency introduced by
\SYSTEM{}.
